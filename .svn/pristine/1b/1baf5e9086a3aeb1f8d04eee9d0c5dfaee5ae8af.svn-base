webpackJsonp([7],{IKsO:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("GKmE"),o=a("vLgD"),l={getList:function(t){return Object(o.a)({url:"/manage/domain/list",method:"get",params:t})},getSiteList:function(){return Object(o.a)({url:"/manage/domain/site/list",method:"get"})},getDetectList:function(t){return Object(o.a)({url:"/manage/domain/detect/list",method:"get",params:t})},delete:function(t){return Object(o.a)({url:"/manage/domain/del",method:"post",data:{inId:t}})},add:function(t){return Object(o.a)({url:"/manage/domain/add",method:"post",data:t})},addBatch:function(t){return Object(o.a)({url:"/manage/domain/batch/add",method:"post",data:t})},update:function(t){return Object(o.a)({url:"/manage/domain/update",method:"post",data:t})}},n={name:"domainIndex",data:function(){return{dialogTitle:null,dialogType:"insert",formLabelWidth:"120px",dialogFormVisible:!1,dialogBatchFormVisible:!1,currentRow:{},dataBatchForm:{sitecode:null,domainBatch:null},dataForm:{id:null,sitecode:null,sitedomain:null},formSearch:{sitecode:null,sitedomain:null,domainstate:null,pageSize:10,currentPage:1},siteItems:[],selectedData:[],expandTableData:[],tableData:[],totalCount:0,listLoading:!1,expandListLoading:!1,delLoading:!1,dialogOKLoading:!1,dialogBatchOKLoading:!1}},computed:{},created:function(){},mounted:function(){this.init(),this.onSearch()},methods:{expandChange:function(t,e){this.detectDate(t.id)},tableChange:function(t,e,a){this.currentRow=t,this.$refs.multipleTable.toggleRowSelection(t)},checkBox:function(t){var e=this;t&&t.length>0&&(this.selectedData=[],t.forEach(function(t){e.selectedData.push(t.id)}))},init:function(){var t=this;l.getSiteList().then(function(e){t.siteItems=e.items}).catch(function(t){})},onSearch:function(){var t=this;this.listLoading=!0,l.getList(this.formSearch).then(function(e){t.totalCount=e.totalCount,t.tableData=e.items,t.listLoading=!1}).catch(function(e){t.listLoading=!1})},detectDate:function(t){var e=this;this.expandListLoading=!0,this.expandTableData=[],l.getDetectList({id:t}).then(function(t){e.expandTableData=t.items,e.expandListLoading=!1}).catch(function(t){e.expandListLoading=!1})},addData:function(){this.dialogTitle="新增域名地址",this.dialogType="insert",this.dialogFormVisible=!0},addBatch:function(){this.dialogBatchFormVisible=!0},updateData:function(){if(i.a.isEmpty(this.currentRow))return this.$root.$message.error("请选择您要编辑的域名。"),!1;this.dialogTitle="编辑域名地址",this.dialogType="update",this.dataForm.id=this.currentRow.id,this.dataForm.sitecode=this.currentRow.sitecode,this.dataForm.sitedomain=this.currentRow.sitedomain,this.dialogFormVisible=!0},deleteData:function(){var t=this;if(this.selectedData.length<=0)return this.$root.$message.error("请选择您要删除的域名。"),!1;var e=this;this.delLoading=!0,l.delete(this.selectedData.toString()).then(function(a){t.$root.$message.success(a.message),e.delLoading=!1,t.onSearch()}).catch(function(t){e.delLoading=!1})},handleSizeChange:function(t){this.formSearch.pageSize=t,this.formSearch.currentPage=1,this.onSearch()},handleCurrentChange:function(t){this.formSearch.currentPage=t,this.onSearch()},dialogCancel:function(){this.dialogFormVisible=!1,this.clearForm()},dialogOK:function(){"insert"===this.dialogType&&this.save(),"update"===this.dialogType&&this.update()},dialogBatchOK:function(){this.saveBatch()},clearForm:function(){this.dataForm.id=null,this.dataForm.sitecode=null,this.dataForm.sitedomain=null},clearBatchForm:function(){this.dataBatchForm.sitecode=null,this.dataBatchForm.domainBatch=null},save:function(){var t=this;this.dialogOKLoading=!0,l.add(this.dataForm).then(function(e){t.$root.$message.success(e.message),t.dialogOKLoading=!1,t.dialogFormVisible=!1,t.clearForm(),t.onSearch()}).catch(function(e){t.dialogOKLoading=!1})},saveBatch:function(){var t=this;this.dialogBatchOKLoading=!0,l.addBatch(this.dataBatchForm).then(function(e){t.$root.$message.success(e.message),t.dialogBatchOKLoading=!1,t.dialogBatchFormVisible=!1,t.clearBatchForm(),t.onSearch()}).catch(function(e){t.dialogBatchOKLoading=!1})},update:function(){var t=this;this.dialogOKLoading=!0,l.update(this.dataForm).then(function(e){t.$root.$message.success(e.message),t.dialogOKLoading=!1,t.dialogFormVisible=!1,t.clearForm(),t.onSearch()}).catch(function(e){t.dialogOKLoading=!1})}}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"form-context"},[a("el-form",{attrs:{inline:!0,model:t.formSearch}},[a("el-form-item",[a("el-select",{staticStyle:{width:"150px"},attrs:{clearable:"",placeholder:"选择站点"},model:{value:t.formSearch.sitecode,callback:function(e){t.$set(t.formSearch,"sitecode",e)},expression:"formSearch.sitecode"}},t._l(t.siteItems,function(t){return a("el-option",{key:t.sitecode,attrs:{label:t.sitename,value:t.sitecode}})}))],1),t._v(" "),a("el-form-item",[a("el-input",{attrs:{placeholder:"请输入搜索域名"},model:{value:t.formSearch.sitedomain,callback:function(e){t.$set(t.formSearch,"sitedomain",e)},expression:"formSearch.sitedomain"}})],1),t._v(" "),a("el-form-item",[a("el-select",{staticStyle:{width:"120px"},attrs:{clearable:"",placeholder:"选择状态"},model:{value:t.formSearch.domainstate,callback:function(e){t.$set(t.formSearch,"domainstate",e)},expression:"formSearch.domainstate"}},[a("el-option",{attrs:{label:"正常",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"无效",value:"0"}}),t._v(" "),a("el-option",{attrs:{label:"未检测",value:"2"}}),t._v(" "),a("el-option",{attrs:{label:"区域劫持",value:"3"}}),t._v(" "),a("el-option",{attrs:{label:"严重劫持",value:"4"}})],1)],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",loading:t.listLoading},on:{click:t.onSearch}},[t._v("搜索")])],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:t.addData}},[t._v("新增")])],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:t.addBatch}},[t._v("批量导入")])],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit"},on:{click:t.updateData}},[t._v("编辑")])],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",loading:t.delLoading},on:{click:t.deleteData}},[t._v("删除")])],1)],1)],1),t._v(" "),a("div",{staticClass:"data-context"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"","element-loading-text":"Loading","element-loading-background":"rgba(0, 0, 0, 0.7)","header-cell-style":{background:"#f8f8f9"},"highlight-current-row":""},on:{"selection-change":t.checkBox,"expand-change":t.expandChange,"row-click":t.tableChange}},[a("el-table-column",{attrs:{type:"selection",prop:"id",width:"37","max-width":"37"}}),t._v(" "),a("el-table-column",{attrs:{prop:"sitename",label:"所属站点",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"sitecode",label:"站点标识",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"sitedomain",label:"域名地址",width:"220"}}),t._v(" "),a("el-table-column",{attrs:{prop:"domainstate",label:"状态",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.domainstate?a("el-button",{attrs:{size:"mini",type:"info"}},[t._v("无效")]):t._e(),t._v(" "),1==e.row.domainstate?a("el-button",{attrs:{size:"mini",type:"success"}},[t._v("正常")]):t._e(),t._v(" "),2==e.row.domainstate?a("el-button",{attrs:{size:"mini"}},[t._v("未检测")]):t._e(),t._v(" "),3==e.row.domainstate?a("el-button",{attrs:{size:"mini",type:"warning"}},[t._v("区域劫持")]):t._e(),t._v(" "),4==e.row.domainstate?a("el-button",{attrs:{size:"mini",type:"danger"}},[t._v("严重劫持")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"createtime",label:"创建日期"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n\t    \t   \t\t\t"+t._s(t._f("dateFormat")(e.row.createtime,"yyyy-MM-dd hh:mm:ss"))+"\n\t    \t   \t\t")]}}])}),t._v(" "),a("el-table-column",{attrs:{type:"expand",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"expand-data-context"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.expandListLoading,expression:"expandListLoading"}],staticStyle:{width:"100%"},attrs:{data:t.expandTableData,border:"","element-loading-text":"Loading","element-loading-background":"rgba(0, 0, 0, 0.7)","header-cell-style":{background:"#f8f8f9"}}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"65"}}),t._v(" "),a("el-table-column",{attrs:{prop:"ip",label:"监测点",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"isp",label:"ISP",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"country",label:"国家",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"area",label:"省份",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"region",label:"地区",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"connCost",label:"连接时间",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"httpCode",label:"状态",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return e.row.httpCode?[200!=e.row.httpCode?a("el-tag",{attrs:{size:"medium",type:"danger"}},[t._v(t._s(e.row.httpCode))]):a("el-tag",{attrs:{size:"medium",type:"success"}},[t._v(t._s(e.row.httpCode))])]:void 0}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"header",label:"请求头"}})],1)],1)]}}])})],1)],1),t._v(" "),t.totalCount>t.formSearch.pageSize?a("div",{staticClass:"page-context clearfix"},[a("div",{staticClass:"page-context-right"},[a("el-pagination",{attrs:{"current-page":t.formSearch.currentPage,"page-sizes":[10,20,30,40,50],"page-size":t.formSearch.pageSize,layout:"total, sizes, prev, pager, next",total:t.totalCount},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)]):t._e(),t._v(" "),a("div",{staticClass:"dialog-context"},[a("el-dialog",{attrs:{title:t.dialogTitle,width:"28%",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e},close:t.dialogCancel}},[a("el-form",{attrs:{model:t.dataForm}},[a("el-form-item",{attrs:{label:"站点选择","label-width":t.formLabelWidth}},[a("el-select",{staticStyle:{width:"260px"},attrs:{placeholder:"选择站点"},model:{value:t.dataForm.sitecode,callback:function(e){t.$set(t.dataForm,"sitecode",e)},expression:"dataForm.sitecode"}},t._l(t.siteItems,function(t){return a("el-option",{key:t.sitecode,attrs:{label:t.sitename,value:t.sitecode}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"域名地址","label-width":t.formLabelWidth}},[a("el-input",{staticStyle:{width:"260px"},attrs:{clearable:"",placeholder:"请输入域名地址"},model:{value:t.dataForm.sitedomain,callback:function(e){t.$set(t.dataForm,"sitedomain",e)},expression:"dataForm.sitedomain"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.dialogCancel}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary",loading:t.dialogOKLoading},on:{click:t.dialogOK}},[t._v("确 定")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"批量导入域名",width:"28%",visible:t.dialogBatchFormVisible},on:{"update:visible":function(e){t.dialogBatchFormVisible=e}}},[a("el-form",{attrs:{model:t.dataBatchForm}},[a("el-form-item",{attrs:{label:"站点选择","label-width":t.formLabelWidth}},[a("el-select",{staticStyle:{width:"260px"},attrs:{placeholder:"选择站点"},model:{value:t.dataBatchForm.sitecode,callback:function(e){t.$set(t.dataBatchForm,"sitecode",e)},expression:"dataBatchForm.sitecode"}},t._l(t.siteItems,function(t){return a("el-option",{key:t.sitecode,attrs:{label:t.sitename,value:t.sitecode}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"域名地址","label-width":t.formLabelWidth}},[a("el-input",{staticStyle:{width:"96%"},attrs:{clearable:"",type:"textarea",rows:6,placeholder:"请输入域名地址一行一个"},model:{value:t.dataBatchForm.domainBatch,callback:function(e){t.$set(t.dataBatchForm,"domainBatch",e)},expression:"dataBatchForm.domainBatch"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){this.dialogBatchFormVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary",loading:t.dialogBatchOKLoading},on:{click:t.dialogBatchOK}},[t._v("确 定")])],1)],1)],1)])},staticRenderFns:[]},r=a("VU/8")(n,s,!1,null,null,null);e.default=r.exports}});