webpackJsonp([4],{JKqP:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("GKmE"),o=a("vLgD"),l={getList:function(t){return Object(o.a)({url:"/manage/site/list",method:"get",params:t})},delete:function(t){return Object(o.a)({url:"/manage/site/del",method:"post",data:{inId:t}})},add:function(t){return Object(o.a)({url:"/manage/site/add",method:"post",data:t})},update:function(t){return Object(o.a)({url:"/manage/site/update",method:"post",data:t})}},s={name:"domainIndex",data:function(){return{dialogTitle:null,dialogType:"insert",formLabelWidth:"120px",dialogFormVisible:!1,currentRow:{},dataForm:{id:null,sitename:null,sitecode:null,sitestate:"1"},formSearch:{sitename:null,sitestate:null,pageSize:10,currentPage:1},siteRules:{sitename:[{required:!0,trigger:"blur",message:" "}],sitecode:[{required:!0,trigger:"blur",message:" ",pattern:/^[a-zA-Z0-9_-]{4,16}$/}]},selectedData:[],tableData:[],totalCount:0,listLoading:!1,delLoading:!1,dialogOKLoading:!1}},computed:{},created:function(){},mounted:function(){this.onSearch()},methods:{tableChange:function(t,e,a){this.currentRow=t,this.$refs.multipleTable.toggleRowSelection(t)},checkBox:function(t){var e=this;t&&t.length>0&&(this.selectedData=[],t.forEach(function(t){e.selectedData.push(t.id)}))},onSearch:function(){var t=this;this.listLoading=!0,l.getList(this.formSearch).then(function(e){t.totalCount=e.totalCount,t.tableData=e.items,t.listLoading=!1}).catch(function(e){t.listLoading=!1})},addData:function(){this.dialogTitle="新增站点信息",this.dialogType="insert",this.dialogFormVisible=!0},updateData:function(){if(i.a.isEmpty(this.currentRow))return this.$root.$message.error("请选择您要编辑的站点。"),!1;this.dialogTitle="编辑站点信息",this.dialogType="update",this.dataForm.id=this.currentRow.id,this.dataForm.sitecode=this.currentRow.sitecode,this.dataForm.sitename=this.currentRow.sitename,this.dataForm.sitestate=this.currentRow.sitestate.toString(),this.dialogFormVisible=!0},deleteData:function(){var t=this;if(this.selectedData.length<=0)return this.$root.$message.error("请选择您要删除的域名。"),!1;var e=this;this.delLoading=!0,l.delete(this.selectedData.toString()).then(function(a){t.$root.$message.success(a.message),e.delLoading=!1,t.onSearch()}).catch(function(t){e.delLoading=!1})},handleSizeChange:function(t){this.formSearch.pageSize=t,this.formSearch.currentPage=1,this.onSearch()},handleCurrentChange:function(t){this.formSearch.currentPage=t,this.onSearch()},dialogCancel:function(){this.dialogFormVisible=!1,this.clearForm()},dialogOK:function(){var t=this;"insert"===this.dialogType&&this.$refs.dataForm.validate(function(e){if(!e)return console.log("error submit!!"),!1;t.save()}),"update"===this.dialogType&&this.update()},clearForm:function(){this.dataForm.id=null,this.dataForm.sitecode=null,this.dataForm.sitename=null,this.dataForm.sitestate="1"},save:function(){var t=this;this.dialogOKLoading=!0,l.add(this.dataForm).then(function(e){t.$root.$message.success(e.message),t.dialogOKLoading=!1,t.dialogFormVisible=!1,t.clearForm(),t.onSearch()}).catch(function(e){t.dialogOKLoading=!1})},update:function(){var t=this;this.dialogOKLoading=!0,l.update(this.dataForm).then(function(e){t.$root.$message.success(e.message),t.dialogOKLoading=!1,t.dialogFormVisible=!1,t.clearForm(),t.onSearch()}).catch(function(e){t.dialogOKLoading=!1})}}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"form-context"},[a("el-form",{attrs:{inline:!0,model:t.formSearch}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"请输入站点名称"},model:{value:t.formSearch.sitename,callback:function(e){t.$set(t.formSearch,"sitename",e)},expression:"formSearch.sitename"}})],1),t._v(" "),a("el-form-item",[a("el-select",{staticStyle:{width:"120px"},attrs:{clearable:"",placeholder:"选择状态"},model:{value:t.formSearch.sitestate,callback:function(e){t.$set(t.formSearch,"sitestate",e)},expression:"formSearch.sitestate"}},[a("el-option",{attrs:{label:"正常",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"无效",value:"0"}})],1)],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",loading:t.listLoading},on:{click:t.onSearch}},[t._v("搜索")])],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:t.addData}},[t._v("新增")])],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit"},on:{click:t.updateData}},[t._v("编辑")])],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",loading:t.delLoading},on:{click:t.deleteData}},[t._v("删除")])],1)],1)],1),t._v(" "),a("div",{staticClass:"data-context"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"","element-loading-text":"Loading","element-loading-background":"rgba(0, 0, 0, 0.7)","header-cell-style":{background:"#f8f8f9"},"highlight-current-row":""},on:{"selection-change":t.checkBox,"row-click":t.tableChange}},[a("el-table-column",{attrs:{type:"selection",prop:"id",width:"37","max-width":"37"}}),t._v(" "),a("el-table-column",{attrs:{prop:"sitename",label:"站点名称",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"sitecode",label:"站点标识",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"sitestate",label:"状态",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.sitestate?a("el-button",{attrs:{size:"mini",type:"danger"}},[t._v("无效")]):t._e(),t._v(" "),1==e.row.sitestate?a("el-button",{attrs:{size:"mini",type:"success"}},[t._v("正常")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"createtime",label:"创建日期"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n\t    \t   \t\t\t"+t._s(t._f("dateFormat")(e.row.createtime,"yyyy-MM-dd hh:mm:ss"))+"\n\t    \t   \t\t")]}}])})],1)],1),t._v(" "),t.totalCount>t.formSearch.pageSize?a("div",{staticClass:"page-context clearfix"},[a("div",{staticClass:"page-context-right"},[a("el-pagination",{attrs:{"current-page":t.formSearch.currentPage,"page-sizes":[10,20,30,40,50],"page-size":t.formSearch.pageSize,layout:"total, sizes, prev, pager, next",total:t.totalCount},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)]):t._e(),t._v(" "),a("div",{staticClass:"dialog-context"},[a("el-dialog",{attrs:{title:t.dialogTitle,width:"28%",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e},close:t.dialogCancel}},[a("el-form",{ref:"dataForm",attrs:{model:t.dataForm,"status-icon":"",rules:t.siteRules}},[a("el-form-item",{attrs:{label:"站点名称","label-width":t.formLabelWidth,prop:"sitename"}},[a("el-input",{staticStyle:{width:"260px"},attrs:{clearable:"",placeholder:"请输入站点名称"},model:{value:t.dataForm.sitename,callback:function(e){t.$set(t.dataForm,"sitename",e)},expression:"dataForm.sitename"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"站点标识","label-width":t.formLabelWidth,prop:"sitecode"}},[a("el-input",{staticStyle:{width:"260px"},attrs:{clearable:"",placeholder:"请输入站点标识"},model:{value:t.dataForm.sitecode,callback:function(e){t.$set(t.dataForm,"sitecode",e)},expression:"dataForm.sitecode"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"站点状态","label-width":t.formLabelWidth}},[a("el-select",{staticStyle:{width:"260px"},attrs:{placeholder:"请选择状态"},model:{value:t.dataForm.sitestate,callback:function(e){t.$set(t.dataForm,"sitestate",e)},expression:"dataForm.sitestate"}},[a("el-option",{attrs:{label:"正常",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"无效",value:"0"}})],1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.dialogCancel}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary",loading:t.dialogOKLoading},on:{click:t.dialogOK}},[t._v("确 定")])],1)],1)],1)])},staticRenderFns:[]},n=a("VU/8")(s,r,!1,null,null,null);e.default=n.exports}});